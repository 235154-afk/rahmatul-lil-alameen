<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Rahmatul Lil Alameen - Daily Ayah, Hadith & Dua</title>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Amiri+Quran&family=Noto+Nastaliq+Urdu&family=Poppins:wght@400;600&display=swap" rel="stylesheet">

  

  <style>
    body {font-family:'Poppins',sans-serif;background: url('https://www.transparenttextures.com/patterns/asfalt-dark.png'), linear-gradient(135deg,#f9f9f9,#eef9f6); margin:0;padding:0;color:#2c3e50;background-attachment: fixed;}
    header {background:linear-gradient(90deg,#0f5132,#198754);color:white;padding:18px;font-size:22px;font-weight:bold;display:flex;justify-content:space-between;align-items:center;box-shadow:0 4px 20px rgba(0,0,0,0.2);border-bottom:4px solid #d4af37;}
    header img {height:50px;}
    #logoutBtn {background:#e74c3c;border:none;color:white;padding:8px 15px;border-radius:8px;cursor:pointer;font-size:14px;font-weight:bold;transition:0.3s;}
    #logoutBtn:hover {background:#c0392b;}
    .daily-card,.box {background:#fff;border-radius:20px;box-shadow:0 8px 25px rgba(0,0,0,0.12);margin:20px auto;padding:20px;width:92%;max-width:750px;position: relative;overflow: hidden;transition:0.3s;}
    .daily-card:hover,.box:hover {transform:translateY(-3px);box-shadow:0 12px 28px rgba(0,0,0,0.18);}
    .daily-card h2,.box h3 {color:#0f5132;margin:0;text-align:center;font-size:22px;cursor:pointer;padding:14px;border-radius:12px;background:linear-gradient(135deg,#ecfdf7,#e0f7f3);font-weight:700;position: relative;}
    .arabic {font-family:'Amiri Quran',serif;font-size:30px;direction:rtl;margin:15px 0;text-align:center;color:#0f5132;line-height:1.8;background:#f9fff9;padding:12px;border-radius:12px;border:2px dashed #198754;}
    .reference {font-size:15px;color:#7f8c8d;margin-bottom:10px;font-style:italic;text-align:center;}
    .translation {font-size:17px;margin:8px 0;text-align:center;color:#2c3e50;font-weight:600;}
    .urdu {font-family:'Noto Nastaliq Urdu',serif;font-size:20px;line-height:2;direction:rtl;text-align:right;color:#2c3e50;padding:10px;background:#fafafa;border-left:5px solid #16a085;border-radius:8px;}
    .share-links {margin-top:15px;text-align:center;}
    .btn {padding:10px 18px;border-radius:10px;background:linear-gradient(45deg,#16a085,#1abc9c);color:white;font-size:14px;font-weight:600;border:none;cursor:pointer;transition:all 0.3s;}
    .btn:hover {transform:scale(1.07);box-shadow:0 4px 14px rgba(0,0,0,0.18);}
    #prayer-times {margin-top:15px;padding:0;list-style:none;font-size:16px;font-weight:600;}
    #prayer-times li {background:#ecfdf7;margin:6px auto;padding:12px;border-radius:10px;max-width:260px;text-align:center;transition:0.3s;border:1px solid #16a085;}
    #prayer-times li.highlight {background:#16a085;color:white;font-size:18px;box-shadow:0 0 15px #16a085;}
    #shareModal {display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.6);justify-content:center;align-items:center;z-index:1000;}
    #shareModal .modal-content {background:white;padding:25px;border-radius:16px;width:340px;text-align:center;box-shadow:0 12px 28px rgba(0,0,0,0.25);border-top:4px solid #16a085;}
    #shareModal h3 {margin-bottom:20px;color:#2c3e50;font-size:20px;}
    .platform-btn {display:block;width:100%;margin:8px 0;padding:12px;border-radius:8px;border:none;cursor:pointer;font-weight:bold;font-size:16px;transition:0.3s;}
    #closeModal {background:#e74c3c;color:white;margin-top:15px;padding:10px;border-radius:8px;border:none;cursor:pointer;}
    #authPage {display:flex;align-items:center;justify-content:center;min-height:100vh;background:linear-gradient(120deg,#0f5132,#198754);padding:20px;}
    .auth-container {background:#fff;width:100%;max-width:450px;border-radius:12px;padding:30px;box-shadow:0 10px 25px rgba(0,0,0,0.2);}
    .auth-container h2 {text-align:center;margin-bottom:20px;color:#16a085;}
    .auth-input {width:100%;padding:12px;border:1px solid #ccc;border-radius:8px;margin:8px 0;font-size:15px;}
    .auth-btn {width:100%;padding:12px;background:linear-gradient(45deg,#0f5132,#198754);border:none;border-radius:8px;color:white;font-size:16px;cursor:pointer;margin-top:12px;font-weight:bold;}
    .switch-link {text-align:center;margin-top:15px;color:#16a085;font-weight:600;cursor:pointer;}
    footer {text-align:center;color:#95a5a6;margin:40px 0 20px;font-size:14px;}
    #nextPrayerInfo {text-align:center;margin-top:12px;font-weight:700;}
    .small-muted {font-weight:500;color:#6c757d;font-size:13px;text-align:center;margin-top:6px;}
  </style>
</head>
<body>

<!-- AUTH PAGE -->
<div id="authPage">
  <div class="auth-container" id="loginBox">
    <h2>Login</h2>
    <input type="text" id="loginUsername" class="auth-input" placeholder="Username">
    <input type="password" id="loginPassword" class="auth-input" placeholder="Password">
    <button class="auth-btn" id="loginBtn">Login</button>
    <div class="switch-link" id="toRegister">Don't have an account? Register</div>
  </div>

  <div class="auth-container" id="registerBox" style="display:none;">
    <h2>Register</h2>
    <input type="text" id="firstName" class="auth-input" placeholder="First Name">
    <input type="text" id="middleName" class="auth-input" placeholder="Middle Name">
    <input type="text" id="lastName" class="auth-input" placeholder="Last Name">
    <input type="text" id="fatherName" class="auth-input" placeholder="Father Name">
    <input type="number" id="age" class="auth-input" placeholder="Age">
    <select id="gender" class="auth-input">
      <option value="">Select Gender</option>
      <option value="Male">Male</option>
      <option value="Female">Female</option>
    </select>
    <input type="text" id="phone" class="auth-input" placeholder="Phone Number">
    <input type="text" id="regUsername" class="auth-input" placeholder="Username">
    <input type="password" id="regPassword" class="auth-input" placeholder="Password">
    <button class="auth-btn" id="registerBtn">Register</button>
    <div class="switch-link" id="toLogin">Already have an account? Login</div>
  </div>
</div>

<!-- MAIN CONTENT -->
<div id="mainContent" style="display:none;">
  <header>
    <div><img src="mylogo.jpg" alt="Logo"> ๐ Rahmatul Lil Alameen</div>
    <button id="logoutBtn">Logout</button>
  </header>

  <!-- Ayah -->
<div class="daily-card" id="ayah-card">
  <h2>๐ Ayah of the Day โ ุฑูุฒุงู ฺฉ ุขุช โ ุขูุฉ ุงูููู</h2>
  <div class="content" style="display:none;">
    <p class="arabic" id="ayah-ar">๏ดฟููููุง ุฃูุฑูุณูููููุงูู ุฅููููุง ุฑูุญูููุฉู ูููููุนูุงููููููู๏ดพ</p>
    <p class="reference" id="ayah-ref">(Reference: Qurโan, Surah Al-Anbiya, verse 107)</p>
    <p class="translation" id="ayah-tr">โAnd We have not sent you, [O Muhammad], except as a mercy to the worlds.โ</p>
    <p class="urdu" id="ayah-ur">โุงูุฑ ู ู ุขูพ ฺฉู ูฺบ ุจฺพุฌุง ูฺฏุฑ ุชูุงู ุฌุงููฺบ ฺฉ ู ุฑุญูุช ุจูุง ฺฉุฑโ</p>
    <div class="share-links"><button class="btn share-btn" data-card="ayah-card">Share</button></div>
  </div>
</div>

<!-- Hadith -->
<div class="daily-card" id="hadith-card">
  <h2>๐ Hadith of the Day โ ุญุฏุซ โ ุงูุญุฏูุซ</h2>
  <div class="content" style="display:none;">
    <p class="arabic" id="hadith-ar">ูุงู ุฑุณูู ุงููู ๏ทบ: ยซุฎูููุฑููููู ูููู ุชูุนูููููู ุงููููุฑูุขูู ููุนููููููููยป</p>
    <p class="reference" id="hadith-ref">(Reference: Sahih al-Bukhari, Book of Virtues of the Qurโan, Hadith 5027)</p>
    <p class="translation" id="hadith-tr">The Prophet ๏ทบ said: โThe best among you are those who learn the Qurโan and teach it.โ</p>
    <p class="urdu" id="hadith-ur">ูุจ ๏ทบ ู ูุฑูุงุง: โุชู ูฺบ ุณุจ ุณ ุจุชุฑ ู ฺบ ุฌู ูุฑุขู ุณฺฉฺพฺบ ุงูุฑ ุณฺฉฺพุงุฆฺบโ</p>
    <div class="share-links"><button class="btn share-btn" data-card="hadith-card">Share</button></div>
  </div>
</div>

<!-- Dua -->
<div class="daily-card" id="dua-card">
  <h2>๐คฒ Dua of the Day ุฏุนุง โ ุงูุฏููุนุงุก</h2>
  <div class="content" style="display:none;">
    <p class="arabic" id="dua-ar-1"> ุงููููููููู ุงุบูููุฑู ููู ุฐููููุจูู ูููููููุง</p>
    <p class="reference" id="dua-ref-1">(Reference: Sahih Muslim, Book of Prayer, Hadith 271)</p>
    <p class="translation" id="dua-tr-1">O Allah, forgive me all my sins.</p>
    <p class="urdu" id="dua-ur-1">ุง ุงูู! ูุฑ ุชูุงู ฺฏูุงูฺบ ฺฉู ูุนุงู ูุฑูุง</p>
    <div class="share-links"><button class="btn share-btn" data-card="dua-card">Share</button></div>
  </div>
</div>

<!-- Quote -->
<div class="box" id="quote-box">
  <h3>๐ฌ Islamic Quote โ ุงุณูุงู ููู โ ุงูุชุจุงุณ</h3>
  <div class="content" style="display:none;">
      <p class="arabic">ุงูุชููู ุฃุณุงุณ ูู ุฎูุฑ</p>
      <p class="translation">Piety is the foundation of all good.</p>
      <p class="urdu">ุชูููฐ ุฑ ูฺฉ ฺฉ ุจูุงุฏ </p>
    <div class="share-links"><button class="btn share-btn" data-card="quote-box">Share</button></div>
  </div>
</div>

<!-- Motivation -->
<div class="box" id="motivation-box">
  <h3>๐ Motivation โ ุญูุตู ุงูุฒุงุฆ โ ุงูุชุญููุฒ</h3>
  <div class="content" style="display:none;">
      <p class="translation">Stay consistent in your good deeds, even if they are small.</p>
      <p class="urdu">ุงูพู ูฺฉ ุงุนูุงู ูฺบ ูุณุชูู ุฑฺบ ฺุง ู ฺฺพููน  ฺฉูฺบ ู ูฺบ</p>
      <p class="arabic">ุฅุณุชูุฑ ุนูู ุงูุฃุนูุงู ุงูุตุงูุญุฉ ููู ูุงูุช ููููุฉ</p>
    <div class="share-links"><button class="btn share-btn" data-card="motivation-box">Share</button></div>
  </div>
</div>

<!-- Azkaar -->
<div class="box" id="azkaar-box">
  <h3>๐ Azkaar โ ุงุฐฺฉุงุฑ โ ุงูุฃุฐูุงุฑ</h3>
  <div class="content" style="display:none;">
      <p class="arabic">ุณูุจูุญูุงูู ุงูููููู ููุจูุญูููุฏููู ุณูุจูุญูุงูู ุงูููููู ุงููุนูุธูููู</p>
      <p class="translation">Glory be to Allah and all praise is due to Him. Glory be to Allah the Great.</p>
      <p class="urdu">ุงูู ูพุงฺฉ  ุงูุฑ ุงุณ ฺฉ ู ุญูุฏ ุ ุงูู ุนุธู ูพุงฺฉ </p>
    <div class="share-links"><button class="btn share-btn" data-card="azkaar-box">Share</button></div>
  </div>
</div>

<!-- Seerah -->
<div class="box" id="seerah-box">
  <h3>๐ Seerah โ ุณุฑุช ุฎุงุชู ุงูุงูุจุงุก ูุญูุฏ ูุตุทููฐ ๏ทบ</h3>
  <div class="content urdu" id="seerah-text" style="display:none;">
   <!-- ... (omitted for brevity in this sample; keep your original long seerah text) ... -->
<p>ุญุถุฑุช ุงุจุฑุงู ุนู ุงูุณูุงู ฺฉ ุจูน ุญุถุฑุช ุงุณูุงุนู ุนู ุงูุณูุงู ฺฉ ูกฒ ุจูน ุชฺพ - ุงู ฺฉ ูุณู ุงุณูุฏุฑ ูุฆ ฺฉ ูฺฉ ูฺฉุฑู ูฺบ ู ุณูุง ุณฺฉ ุงูุฑ ูพูุฑ ุญุฌุงุฒ ูฺบ ูพฺพู ฺฏุฆ - ุงู ฺฉ ุงฺฉ ุจูน ูุฏุงุฑ ฺฉ ุงููุงุฏ ูฺบ ุนุฏูุงู ูุฆ - ุนุฏูุงู ฺฉ ุจูน ูุนุฏ ุงูุฑ ูพูุช ฺฉุง ูุงู ูุฒุงุฑ ุชฺพุง - ูุฒุงุฑ ฺฉ ฺุงุฑ ุจูน ุชฺพ - ุงู ูฺบ ุณ ุงฺฉ ฺฉุง ูุงู ูุถุฑ ุชฺพุง - ูุถุฑ ฺฉ ูุณู ุณ ูุฑุด ุจู ูุงูฺฉ ูพุฏุง ูุฆ"  ูุฑ ุจู ูุงูฺฉ ุจฺพ ฺฉูุงุฆ - ูุฑุด ฺฉ ุงููุงุฏ ุจุช ูุฆ - ุงู ฺฉ ุงููุงุฏ ูุฎุชูู ูุจููฺบ ูฺบ ุจูน ฺฏุฆ - ุงู ฺฉ ุงููุงุฏ ุณ ูุตู ู ุงูุชุฏุงุฑ ุญุงุตู ฺฉุง - ูุตู ฺฉ ุขฺฏ ุชู ุจูน ูุฆ - ุงู ูฺบ ุณ ุงฺฉ ุนุจุฏ ููุงู ุชฺพ ุฌู ฺฉ ุงฺฏู ูุณู ูฺบ ุงุดู ูพุฏุง ูุฆ -</p>
          <p>ุงุดู ู ูุฏู ฺฉ ุงฺฉ ุณุฑุฏุงุฑ ฺฉ ูฺฺฉ ุณ ุดุงุฏ ฺฉ " ุงู ฺฉ ุงฺบ ุงฺฉ ูฺฺฉุง ูพุฏุง ูุง " ุงุณ ฺฉุง ูุงู ุดุจ ุฑฺฉฺพุง ฺฏุง -  ูพุฏุง  ูุง ุชฺพุง ฺฉ ุงุดู ฺฉุง ุงูุชูุงู ูฺฏุง- ุงู ฺฉ ุจฺพุงุฆ ูุทููุจ ูฺฉ ฺฉ ุญุงฺฉู ูุฆ - ุงุดู ฺฉุง ุจูนุง ูุฏู ูููุฑ ูฺบ ูพุฑูุฑุด ูพุงุชุง ุฑุง " ุฌุจ ูุทููุจ ฺฉู ูุนููู ูฺฏุง ฺฉ ู ุฌูุงู ูฺฏุง  ุชู ุจฺพุชุฌ ฺฉู ูู ฺฉ ู ุฎูุฏ ูุฏู ฺฏุฆ - ุงุณ ูฺฉุฑ ูฺฉ ูฺฉุฑู ูพูฺ ุชู ููฺฏูฺบ ู ุฎุงู ฺฉุง  ููุฌูุงู ุงู ฺฉุง ุบูุงู  - ูุทููุจ ู ููฺฏูฺบ ฺฉู ุจุชุงุง "  ุงุดู ฺฉุง ุจูนุง ุงูุฑ ูุฑุง ุจฺพุชุฌุง  " ุงุณ ฺฉ ุจุงูุฌูุฏ ููฺฏูฺบ ู ุงุณ ูุทููุจ ฺฉุง ุบูุงู  ฺฉูุง ุดุฑูุน ฺฉุฑุฏุง - ุงุณ ุทุฑุญ ุดุจ ฺฉู ุนุจุฏุงููุทูุจ ฺฉุง ุฌุงู ูฺฏุง - ุงูฺบ ุนุจุฏุงููุทูุจ ฺฉ ุงฺบ ุงุจูุทุงูุจ ุญูุฒ, ุนุจูุงุณ, ุนุจุฏุงูู, ุงุจููุจ, ุญุงุฑุซ, ุฒุจุฑ, ุถุฑุงุฑ, ุงูุฑ ุนุจุฏุงูุฑุญูู ูพุฏุง ูุฆ- ุงู ฺฉ ุจูน ุนุจุฏุงูู ุณ ูุงุฑ ูุจ ุญุถุฑุช ูุญูุฏ ุตู ุงูู ุนู ู ุณูู ูพุฏุง ูุฆ</p>
          <p>ุนุจุฏุงููุทูุจ ฺฉ ุชูุงู ุจูนูฺบ ูฺบ ุญุถุฑุช ุนุจุฏุงูู ุณุจ ุณ ุฒุงุฏ ุฎูุจุตูุฑุช ุงูุฑ ุณุจ ุณ ุฒุงุฏ ูพุงฺฉุฏุงูู ุชฺพ - ุนุจุฏุงููุทูุจ ฺฉู ุฎูุงุจ ูฺบ ุฒูุฒู ฺฉุง ฺฉููุงฺบ ฺฉฺพูุฏู ฺฉุง ุญฺฉู ุฏุง ฺฏุง " ุนู ุญุถุฑุช ุงุณูุงุนู ุนู ุงูุณูุงู ฺฉ ฺฉููฺบ ฺฉู, ุงุณ ฺฉููฺบ ฺฉู ูุจู ุฌุฑู ฺฉ ุณุฑุฏุงุฑ ูุถุงุถ ู ูพุงูน ุฏุง ุชฺพุง - ูุจู ุฌุฑู ฺฉ ููฺฏ ุงุณ ุฒูุงู ูฺบ ูฺฉ ฺฉ ุณุฑุฏุงุฑ ุชฺพ " ุจุช ุงูู ฺฉ ูฺฏุฑุงฺบ ุชฺพ - ุงููฺบ ู ุจุช ุงูู ฺฉ ุจ ุญุฑูุช ุดุฑูุน ฺฉุฑุฏ - ุงู ฺฉุง ุณุฑุฏุงุฑ ูุถุงุถ ุจู ุนูุฑู ุชฺพุง " ู ุงฺฺพุง ุขุฏู ุชฺพุง ุงุณ ู ุงูพู ูุจู ฺฉู ุณูุฌฺพุงุง ฺฉ ุจุช ุงูู ฺฉ ุจ ุญุฑูุช ู ฺฉุฑู ูฺฏุฑ ุงู ูพุฑ ุงุซุฑ ู ูุง " ุฌุจ ูุถุงุถ ู ุฏฺฉฺพุง ฺฉ ุงู ูพุฑ ฺฉูุฆ ุงุซุฑ ู ูุชุง ุชู ููู ฺฉู ุงุณ ฺฉ ุญุงู ูพุฑ ฺฺพูฺ ฺฉุฑ ูุงฺบ ุณ ุฌุงู ฺฉุง ูุตู ฺฉุง- ุงุณ ู ุชูุงู ูุงู ู ุฏููุช ุชููุงุฑฺบ ุงูุฑ ุฒุฑฺบ ูุบุฑ ุฎุงู ฺฉุนุจ ุณ ูฺฉุงู ฺฉุฑ ุฒูุฒู ฺฉ ฺฉููฺบ ูฺบ ฺุงูุฏฺบ ุงูุฑ ููน ุณ ุงุณฺฉู ูพุงูน ุฏุง - ฺฉููุงฺบ ุงุณ ุณ ูพู  ุฎุดฺฉ ูฺฺฉุง ุชฺพุง-</p>
          <p>ุงุจ ุงุณ ฺฉุง ูุงู ู ูุดุงู ููน ฺฏุง - ูุฏุชูฺบ  ฺฉููุงฺบ ุจูุฏ ูพฺุง ุฑุง ุงุณ ฺฉ ุจุนุฏ ุจูู ุฎุฒุงุน ู ุจูู ุฌุฑู ฺฉู ูุงฺบ ุณ ูุงุฑ ุจฺพฺฏุงุง " ุจูู ุฎุฒุงุน ุงูุฑ ูุตู ฺฉ ุณุฑุฏุงุฑ ฺฉุง ุฒูุงู ุงุณ ุญุงูุช ูฺบ ฺฏุฐุฑุง - ฺฉููุงฺบ ุจูุฏ ุฑุง ุงฺบ ุชฺฉ ฺฉ ูุตู ฺฉ ุจุนุฏ ุนุจุฏุงููุทูุจ ฺฉุง ุฒูุงู ุขฺฏุง" ุงููฺบ ู ุฎูุงุจ ุฏฺฉฺพุง " ุฎูุงุจ ูฺบ ุงูฺบ ุฒูุฒู ฺฉ ฺฉููฺบ ฺฉ ุฌฺฏ ุฏฺฉฺพุงุฆ ฺฏุฆ ุงูุฑ ุงุณ ฺฉ ฺฉฺพูุฏู ฺฉุง ุญฺฉู ุฏุง ฺฏุง-</p>
          <p>ุญุถุฑุช ุนู ุฑุถ ุงูู ุนู ุณ ุฑูุงุช  ฺฉ ุนุจุฏุงููุทูุจ ู ุจุชุงุง :- </p>
          <p>" ูฺบ ุญุฌุฑ ุงุณูุฏ ฺฉ ููุงู ูพุฑ ุณูุฑุง ุชฺพุง ฺฉ ูุฑ ูพุงุณ ุงฺฉ ุขู ูุงูุง ุขุง - ุงุณ ู ูุฌฺพ ุณ ฺฉุง "ุทุจ ฺฉู ฺฉฺพูุฏู "</p>
          <p>ูฺบ ู ุงุณ ูพูฺฺพุง "ุทุจ ฺฉุง ุ" </p>
          <p>ูฺฏุฑ ู ฺฉฺฺพ ุจุชุงุฆ ุจุบุฑ ฺูุงฺฏุง - ุฏูุณุฑ ุทุฑู ุฑุงุช ูพฺพุฑ ุฎูุงุจ ูฺบ ู ุดุฎุต ุขุง " ฺฉู ูฺฏุง "ุจุฑ ฺฉู ฺฉฺพูุฏู "</p>
          <p>ูฺบ ู ูพูฺฺพุง "ุจุฑู ฺฉุง " ู ฺฉฺฺพ ุจุชุงุฆ ุจุบุฑ ฺู ฺฏุง-</p>
          <p>ุชุณุฑ ุฑุงุช ูฺบ ุงูพู ุจุณุชุฑ ูพุฑ ุณูุฑุง ุชฺพุง ฺฉ ูพฺพุฑ ู ุดุฎุต ุฎูุงุจ ูฺบ ุขุง - ุงูุณ ู ฺฉุง " ูุถููู ฺฉฺพูุฏู " </p>
          <p>ูฺบ ู ูพูฺฺพุง " ูุถููู ฺฉุง ุ" ู ุจุชุงุฆ ุจุบุฑ ฺูุง ฺฏุง - </p>
          <p>ุงุณ ุณ ุงฺฏู ุฑุงุช ูฺบ ูพฺพุฑ ุจุณุชุฑ ูพุฑ ุณูุฑุง ุชฺพุง ฺฉ ู ุดุฎุต ูพฺพุฑ ุขุง ุงูุฑ ุจููุง "ุฒู ุฒู ฺฉฺพูุฏู " ูฺบ ู ุงุณ ุณ ูพูฺฺพุง "ุฒู ุฒู ฺฉุง ุ " ุงุณ ุจุงุฑ ุงุณ ู ฺฉุง:</p>
          <p>" ุฒูุฒู ู  ุฌุณ ฺฉุง ูพุงู ฺฉุจฺพ ุฎุชู ูฺบ ูุชุง, ุฌู ุญุงุฌูฺบ ฺฉ ุจฺ ุจฺ ูุฌููุนูฺบ ฺฉู ุณุฑุงุจ ฺฉุฑุชุง  " </p>
          <p>ุนุจุฏุงููุทูุจ ฺฉุช ฺบ , ูฺบ ู ุงุณ ุณ ูพูฺฺพุง " ฺฉููุงฺบ ฺฉุณ ุฌฺฏ ุ " ุงุณ ู ุจุชุงุง - </p>
          <p>"ุฌุงฺบ ฺฏูุฏฺฏ ุงูุฑ ุฎูู ูพฺุง , ุงูุฑ ฺฉููุง ูนฺพููฺฏฺบ ูุงุฑ ุฑุง " </p>
          <p>ุฏูุณุฑ ุฏู ุนุจุฏุงููุทูุจ ุงูพู ุจูน ุญุงุฑุซ ฺฉ ุณุงุชฺพ ูุงฺบ ฺฏุฆ - ุงุณ ููุช ุงู ฺฉ ุงฺบ  ุงฺฉ ูฺฺฉุง ุชฺพุง - ุงููฺบ ู ุฏฺฉฺพุง ูุงฺบ ฺฏูุฏฺฏ ุงูุฑ ุฎูู ูพฺุง ุชฺพุง ุงูุฑ ุงฺฉ ฺฉููุง ูนฺพููฺฏฺบ ูุงุฑ ุฑุง ุชฺพุง, ุงุณ ุฌฺฏ ฺฉ ุฏูููฺบ ุทุฑู ุจูุช ููุฌูุฏ ุชฺพ ุงูุฑ  ฺฏูุฏฺฏ ุงูุฑ ุฎูู ุฏุฑุงุตู ุงู ุจุชูฺบ ูพุฑ ูุฑุจุงู ฺฉุฆ ุฌุงู ูุงู ุฌุงููุฑูฺบ ฺฉุง ุชฺพุง, ูพูุฑ ูุดุงู ูู ฺฏุฆ ุชู ุนุจุฏุงููุทูุจ ฺฉุฏุงู ู ุขุฆ ุงูุฑ ฺฉฺพุฏุงุฆ ฺฉ ูุฆ ุชุงุฑ ูฺฏุฆ ูฺฉู ุงุณ ููุช ูุฑุด ูุงฺบ ุข ูพูฺ -ุงููฺบ ู ฺฉุง :</p>
          <p>" ุงูู ฺฉ ูุณู ู ุชูฺบ ุงฺบ ฺฉฺพุฏุงุฆ ูฺบ ฺฉุฑู ุฏฺบ ฺฏ, ุชู ูุงุฑ ุงู ุฏูููฺบ ุจูุชูฺบ ฺฉ ุฏุฑูุงฺบ ฺฉููุงฺบ ฺฉฺพูุฏูุง ฺุงุช ู ุฌุงฺบ ู ุงู ฺฉ ูุฆ ูุฑุจุงูุงฺบ ฺฉุฑุช ฺบ - "</p>
          <p>ุนุจุฏุงููุทูุจ ู ุงู ฺฉ ุจุงุช ุณู ฺฉุฑ ุงูพู ุจูน ุญุงุฑุซ ุณ ฺฉุง : </p>
          <p>"ุชู ุงู ููฺฏูฺบ ฺฉู ูุฑ ูุฑุจ ู ุขู ุฏู, ูฺบ ฺฉฺพุฏุงุฆ ฺฉุง ฺฉุงู ฺฉุฑุชุง ุฑูฺบ ฺฏุง ุงุณ ูุฆ ฺฉ ูุฌฺพ ุฌุณ ฺฉุงู ฺฉุง ุญฺฉู ุฏุง ฺฏุง  ูฺบ ุงุณ ฺฉู ุถุฑูุฑ ูพูุฑุง ฺฉุฑูฺบ ฺฏุง- "</p>
          <p>ูุฑุด ู ุฌุจ ุฏฺฉฺพุง ฺฉ ู ุจุงุฒ ุขู ูุงู ูฺบ ุชู ุฑฺฉ ฺฏุฆ - ุขุฎุฑ ุงูฺพูฺบ ู ฺฉฺพุฏุงุฆ ุดุฑูุน ฺฉุฑุฏ - ุฌูุฏ  ฺฉููฺบ ฺฉ ุขุซุงุฑ ูุธุฑ ุขู ูฺฏ -  ุฏฺฉฺพ ฺฉุฑ ุงููฺบ ู ุงูู ุงฺฉุจุฑ ฺฉุง ูุนุฑ ูฺฏุงุง ุงูุฑ ูพฺฉุงุฑ ุงูนฺพ</p>
          <p>"  ุฏฺฉฺพู  ุงุณูุงุนู ุนู ุงูุณูุงู ฺฉ ุชุนูุฑ  "</p>
          <p>ุฌุจ ูุฑุด ู  ุฏฺฉฺพุง ฺฉ ุงููฺบ ู ฺฉููุงฺบ ุชูุงุด ฺฉุฑูุง ุชู ุงู ฺฉ ูพุงุณ ุขฺฏุฆ ุงูุฑ ฺฉู ูฺฏ : </p>
          <p>"ุนุจุฏุงููุทูุจ ุงูู ฺฉ ูุณู "  ูุงุฑ ุจุงูพ ุงุณูุงุนู ุนู ุงูุณูุงู ฺฉุง ฺฉููุงฺบ  ุงูุฑ ุงุณ ูพุฑ ูุงุฑุง ุจฺพ ุญู " ุงุณ ูุฆ ู ุงุณ ูฺบ ุชูุงุฑ ุดุฑฺฉ ูฺบ ฺฏ -"</p>
          <p> ุณู ฺฉุฑ ุนุจุฏุงููุทูุจ ู ฺฉุง : </p>
          <p>" ูฺบ ุชูฺบ ุงุณ ูฺบ ุดุฑฺฉ ูฺบ ฺฉุฑุณฺฉุชุง "  ูุฌฺพ ุงฺฉู ฺฉุง ฺฉุงู "</p>
          <p>ุงุณ ูพุฑ ูุฑุด ู ฺฉุง : </p>
          <p>" ุชุจ ูพฺพุฑ ุงุณ ูุนุงูู ูฺบ ู ุชู ุณ ุฌฺพฺฏฺุง ฺฉุฑฺบ ฺฏ"</p>
          <p>ุนุจุฏุงููุทูุจ ุจูู :</p>
          <p>" ฺฉุณ ุณ ูุตู ฺฉุฑูุงูู "</p>
          <p>ุงููฺบ ู ุจููุณุนุฏ ุงุจู ุฒู ฺฉ ฺฉุงู ุณ ูุตู ฺฉุฑุงูุง ููุธูุฑ ฺฉุง -  ฺฉุงู ููฺฉ ุดุงู ฺฉ ุจุงูุงุฆ ุนูุงู ูฺบ ุฑุช ุชฺพ - ุขุฎุฑ ุนุจุฏุงููุทูุจ ุงูุฑ ุฏูุณุฑ ูุฑุด ุงุณ ฺฉ ุทุฑู ุฑูุงู ูุฆ - ุนุจุฏุงููุทูุจ ฺฉ ุณุงุชฺพ ุนุจุฏููุงู ฺฉ ููฺฏูฺบ ฺฉ ุงฺฉ ุฌูุงุนุช ุชฺพ - </p>
          <p>ุฌุจฺฉ ุฏฺฏุฑ ูุจุงุฆู ูุฑุด ฺฉ ุจฺพ ุงฺฉ ุงฺฉ ุฌูุงุนุช ุณุงุชฺพ ุชฺพ - ุงุณ ุฒูุงู ูฺบ ููฺฉ ุญุฌุงุฒ ุงูุฑ ุดุงู ฺฉ ุฏุฑูุงู ุงฺฉ ุจุงุจุงู ูุฏุงู ุชฺพุง , ูุงฺบ ฺฉฺบ ูพุงู ูฺบ ุชฺพุง - ุงุณ ูุฏุงู ูฺบ ุงู ฺฉุง ูพุงู ุฎุชู ูฺฏุง - ุณุจ ููฺฏ ูพุงุณ ุณ ุจ ุญุงู ูฺฏุฆ, ุงฺบ ุชฺฉ ฺฉ ุงูฺบ ุงูพู ููุช ฺฉุง ูู ูฺฏุง - ุงููฺบ ู ูุฑุด ฺฉ ุฏูุณุฑ ููฺฏูฺบ ุณ ูพุงู ูุงูฺฏุง ูฺฉู ุงููฺบ ู ูพุงู ุฏู ุณ ุงูฺฉุงุฑ ฺฉุฑุฏุง - ุงุจ ุงููฺบ ูุงุฏฺพุฑ ุงุฏฺพุฑ ูพุงู ุชูุงุด ฺฉุฑู ฺฉุง ุงุฑุงุฏ ฺฉุง - </p>
          <p>ุนุจุฏุงููุทูุจ ุงูนฺพ ฺฉุฑ ุงูพู ุณูุงุฑ ฺฉ ูพุงุณ ุขุฆ, ุฌูฺบ  ุงู ฺฉ ุณูุงุฑ ุงูนฺพ, ุงุณ ฺฉ ูพุงุคฺบ ฺฉ ูฺ ุณ ูพุงู ฺฉุง ฺุดู ุงุจู ูพฺุง - ุงููฺบ ู ูพุงู ฺฉู ุฏฺฉฺพ ฺฉุฑ ุงูู ุงฺฉุจุฑ ฺฉุง ูุนุฑ ูฺฏุงุง - ูพฺพุฑ ุนุจุฏ ุงููุทูุจ ุณูุงุฑ ุณ ุงุชุฑ ุขุฆ - ุณุจ ู ุฎูุจ ุณุฑ ูฺฉุฑ ูพุงู ูพุง ุงูุฑ ุงูพู ูุดฺฉุฒ ุจฺพุฑ ู - ุงุจ ุงููฺบ ู ูุฑุด ฺฉ ุฏูุณุฑ ุฌูุงุนุช ุณ ฺฉุง:"ุขุค ุชู ุจฺพ ุณุฑ ูฺฉุฑ ูพุงู ูพ ูู -" ุงุจ ู ุจฺพ ุขฺฏ ุขุฆ ุงูุฑ ุฎูุจ ูพุงู ูพุง - ูพุงู ูพู ฺฉ ุจุนุฏ ู ุจูู:</p>
          <p>" ุงูู ฺฉ ูุณู.... ุง ุนุจุฏุงููุทูุจ!  ุชู ุชูุงุฑ ุญู ูฺบ ูุตู ูฺฏุง - ุงุจ ู ุฒูุฒู ฺฉ ุจุงุฑ ูฺบ ุชู ุณ ฺฉุจฺพ ุฌฺพฺฏฺุง ูฺบ ฺฉุฑฺบ ฺฏ - ุฌุณ ุฐุงุช ู ุชูฺบ ุงุณ ุจุงุจุงู ูฺบ ุณุฑุงุจ ฺฉุฑุฏุงุ ู ุฐุงุช ุชูฺบ ุฒูุฒู ุณ ุจฺพ ุณุฑุงุจ ฺฉุฑ ฺฏุงุ ุงุณ ู ฺบ ุณ ูุงูพุณ ฺูู -" </p>
          <p>ุงุณ ุทุฑุญ ูุฑุด ู ุฌุงู ูุง ฺฉ ุงูู ุชุนุงููฐ ุนุจุฏุงููุทูุจ ูพุฑ ูุฑุจุงู ุ ููฐุฐุง ุงู ุณ ุฌฺพฺฏฺูุง ุจ ุณูุฏ  ุงูุฑ ฺฉุงู ฺฉ ูพุงุณ ุฌุงู ฺฉุง ฺฉูุฆ ูุงุฆุฏ ูฺบ ุ ฺูุงูฺ ุณุจ ููฺฏ ูุงูพุณ ูููน - </p>
          <p>ูุงูพุณ ุงฺฉุฑ ุนุจุฏุงููุทูุจ ู ูพฺพุฑ ฺฉููฺบ ฺฉ ฺฉฺพุฏุงุฆ ุดุฑูุน ฺฉ - ุงุจฺพ ุชฺพูฺ ุณ ฺฉฺพุฏุงุฆ ฺฉ ูฺฏ ฺฉ ูุงูุ ุฏููุชุ ุชููุงุฑฺบ ุงูุฑ ุฒุฑฺบ ูฺฉู ุขุฆฺบ - ุงุณ ูฺบ ุณููุง ุงูุฑ ฺุงูุฏ ูุบุฑ ุจฺพ ุชฺพ -  ูุงู ูุฏููุช ุฏฺฉฺพ ฺฉุฑ ูุฑุด ฺฉ ููฺฏูฺบ ฺฉู ูุงูฺ ู ุขฺฏฺพุฑุง - ุงููฺบ ู ุนุจุฏุงููุทูุจ ุณ ฺฉุง :</p>
          <p>"ุนุจุฏุงููุทูุจ! ุงุณ ูฺบ ูุงุฑุง ุจฺพ ุญุต  -" </p>
          <p>ุงู ฺฉ ุจุงุช ุณู ฺฉุฑ ุนุจุฏุงููุทูุจ ู ฺฉุง :</p>
          <p>"ูฺบ ! ุงุณ ูฺบ ุชูุงุฑุง ฺฉูุฆ ุญุต ูฺบ ุ ุชูฺบ ุงูุตุงู ฺฉุง ุทุฑู ุงุฎุชุงุฑ ฺฉุฑูุง ฺุง - ุขุค ูพุงูุณู ฺฉ ุชุฑูฺบ ุณ ูุฑุน ฺุงูฺบ -" </p>
          <p>ุงููฺบ ู ุงุณุง ฺฉุฑูุง ููุธูุฑ ฺฉุฑูุง - ุฏู ุชุฑ ฺฉุนุจ ฺฉ ูุงู ุณ ุฑฺฉฺพ ฺฏุฆุ ุฏู ุนุจุฏุงููุทูุจ ฺฉ ุงูุฑ ุฏู ูุฑุด ฺฉ ุจุงู ููฺฏูฺบ ฺฉ ูุงู ฺฉ.... ูพุงูุณ ูพฺพูฺฉุง ฺฏุง ุชู ูุงู ุงูุฑ ุฏููุช ฺฉุนุจ ฺฉ ูุงู ูฺฉูุงุ ุชููุงุฑฺบ ุงูุฑ ุฒุฑฺบ ุนุจุฏุงููุทูุจ ฺฉ ูุงู ุงูุฑ ูุฑุดูฺบ ฺฉ ูุงู ฺฉ ุฌู ุชุฑ ุชฺพ ู ฺฉุณ ฺุฒ ูพุฑ ู ูฺฉู - ุงุณ ุทุฑุญ ูุตู ูฺฏุง - ุนุจุฏุงููุทูุจ ู ฺฉุนุจ ฺฉ ุฏุฑูุงุฒ ฺฉู ุณูู ุณ ุณุฌุง ุฏุง - </p>
          <p>ุฒูุฒู ฺฉ ฺฉฺพุฏุงุฆ ุณ ูพู ุนุจุฏุงููุทูุจ ู ุฏุนุง ูุงูฺฏ ุชฺพ ฺฉ ุง ุงูู! ุงุณ ฺฉ ฺฉฺพุฏุงุฆ ฺฉู ูุฌฺพ ูพุฑ ุขุณุงู ฺฉุฑุฏุ ูฺบ ุงูพูุง ุงฺฉ ุจูนุง ุชุฑ ุฑุงุณุช ูฺบ ุฐุจุญ ฺฉุฑูฺบ ฺฏุง - ุงุจ ุฌุจ ฺฉ ฺฉููุงฺบ ูฺฉู ุขุง ุชู ุงูฺบ ุฎูุงุจ ูฺบ ุญฺฉู ุฏุง ฺฏุง - </p>
          <p>"ุงูพู ููุช ูพูุฑ ฺฉุฑูุ ุนู ุงฺฉ ุจูน ฺฉู ุฐุจุญ ฺฉุฑู -"</p>
          <!-- ... (rest of your seerah text) ... -->
  </div>
  <div class="share-links content" style="display:none;">
    <button class="btn share-btn" data-card="seerah-box">Share</button>
  </div>
</div>

<!-- Prayer Times -->
<div class="box" id="prayer-box">
  <h3>๐ Prayer Timings</h3>
  <div class="content" style="display:none;">
    <div style="display:flex;gap:8px;flex-wrap:wrap;justify-content:center;margin-bottom:10px;">
      <input type="text" id="cityInput" placeholder="Enter city (e.g. Lahore or Lahore, Pakistan)" style="padding:10px;border-radius:8px;border:1px solid #ccc;width:58%;max-width:420px;">
      <button class="btn" id="getTimesBtn">Get Prayer Times</button>
      <button class="btn" id="myLocBtn" title="Use your device location">Use My Location</button>
    </div>
    <ul id="prayer-times"></ul>
    <div id="nextPrayerInfo"></div>
    <div class="small-muted" id="prayerTZInfo"></div>
  </div>
</div>

<footer>ยฉ Rahmatul Lil Alameen</footer>
</div>

<!-- Share Modal -->
<div id="shareModal">
  <div class="modal-content">
    <h3>Share To</h3>
    <button class="platform-btn" data-url="https://wa.me/?text=">WhatsApp</button>
    <button class="platform-btn" id="copyBtn">๐ Copy Text</button>
    <button id="closeModal">Close</button>
  </div>
</div>

<!-- Azan Audio -->
<audio id="azan-audio" src="azan.mp3" preload="auto"></audio>

<script>
let activeCardId = null;
let prayerSchedule = {};
let prayerTimezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
let lastPlayed = {}; // to prevent repeated play per prayer per day

// small safety var (keeps previous code compatibility)
let lastDate = null;

// --------------------
// Utility: load content after login
// --------------------
function loadDailyContent(){
  // show all content sections so user can read them immediately
  $("#mainContent .content").each(function(){
    if($(this).is(":hidden")){
      // use slideDown for nicer effect, zero duration when called programmatically is OK
      $(this).slideDown(200);
    }
  });
  // make sure main content visible
  $("#authPage").hide();
  $("#mainContent").show();

  // Optionally: focus on top
  window.scrollTo({top:0, behavior:'smooth'});

  // If you would like a default city for prayer times, you can uncomment:
  // fetchTimingsByCityInput("Lahore, Pakistan");
}

// --------------------
// On page load: restore session if user logged in earlier (sessionStorage)
$(function(){
  const logged = sessionStorage.getItem('loggedInUser');
  if(logged){
    // Show main content immediately and load content
    loadDailyContent();
  }
});

// ๐น Toggle sections on heading click
$(document).on("click", ".daily-card h2, .box h3", function(){
  $(this).siblings(".content").slideToggle();
});

// ๐น Share functionality
$(document).on("click", ".share-btn", function(){
  // set active card id from data attribute (share buttons have data-card)
  activeCardId = $(this).data("card") || $(this).closest(".daily-card, .box").attr("id");
  $("#shareModal").fadeIn();
});

$("#closeModal").click(() => $("#shareModal").fadeOut());

// Platform share buttons: only those with data-url
$(document).on("click", ".platform-btn[data-url]", function(){
  if(!activeCardId) return;
  // pick visible text from the card content
  const text = $("#" + activeCardId + " .content").text().trim();
  const baseUrl = $(this).data("url");
  const url = baseUrl + encodeURIComponent(text);
  window.open(url, "_blank");
  alert("โ Successfully opened share window for " + $(this).text());
  $("#shareModal").fadeOut();
});

// Copy text button
$("#copyBtn").click(function(){
  if(!activeCardId) return;
  const text = $("#" + activeCardId + " .content").text().trim();
  if(!text){
    alert("Nothing to copy.");
    return;
  }
  navigator.clipboard.writeText(text)
    .then(() => {
      alert("๐ Text copied to clipboard!");
      $("#shareModal").fadeOut();
    })
    .catch(err => {
      console.error("Copy failed:", err);
      alert("Unable to copy text.");
    });
});

// -----------------------------
// Prayer times: fetch + watch
// -----------------------------
$("#getTimesBtn").click(function(){
  let city = $("#cityInput").val().trim();
  if(!city){
    alert("Enter a city or click 'Use My Location'");
    return;
  }
  fetchTimingsByCityInput(city);
});

$("#myLocBtn").click(function(){
  if(!navigator.geolocation){
    alert("Geolocation not supported by this browser.");
    return;
  }
  $("#myLocBtn").prop('disabled',true).text('Locating...');
  navigator.geolocation.getCurrentPosition(function(pos){
    fetchTimingsByCoords(pos.coords.latitude, pos.coords.longitude);
  }, function(err){
    alert("Could not get location: " + err.message);
    $("#myLocBtn").prop('disabled',false).text('Use My Location');
  }, {enableHighAccuracy:true, timeout:10000});
});

function fetchTimingsByCityInput(cityInput){
  let city = cityInput;
  let country = "Pakistan";
  if(cityInput.includes(',')){
    const parts = cityInput.split(',');
    city = parts[0].trim();
    country = parts.slice(1).join(',').trim() || country;
  }
  const url = `https://api.aladhan.com/v1/timingsByCity?city=${encodeURIComponent(city)}&country=${encodeURIComponent(country)}&method=2`;
  $("#getTimesBtn").prop('disabled',true).text('Loading...');
  fetch(url).then(r=>r.json()).then(handleTimings).catch(err=>{
    console.error(err);
    alert("Error fetching prayer times. Try again.");
    $("#getTimesBtn").prop('disabled',false).text('Get Prayer Times');
  });
}

function fetchTimingsByCoords(lat, lon){
  const url = `https://api.aladhan.com/v1/timings?latitude=${lat}&longitude=${lon}&method=2`;
  $("#getTimesBtn").prop('disabled',true).text('Loading...');
  $("#myLocBtn").prop('disabled',true).text('Use My Location');
  fetch(url).then(r=>r.json()).then(handleTimings).catch(err=>{
    console.error(err);
    alert("Error fetching prayer times. Try again.");
    $("#getTimesBtn").prop('disabled',false).text('Get Prayer Times');
    $("#myLocBtn").prop('disabled',false).text('Use My Location');
  });
}

function handleTimings(res){
  if(!res || (res.code && res.code !== 200 && res.status !== "OK")) {
    alert("Failed to fetch timings from API.");
    $("#getTimesBtn").prop('disabled',false).text('Get Prayer Times');
    $("#myLocBtn").prop('disabled',false).text('Use My Location');
    return;
  }
  const data = res.data || res;
  const tz = (data.meta && data.meta.timezone) ? data.meta.timezone : Intl.DateTimeFormat().resolvedOptions().timeZone;
  prayerTimezone = tz;

  const keys = ["Fajr","Dhuhr","Asr","Maghrib","Isha"];

  prayerSchedule = {};
  $("#prayer-times").empty();

  keys.forEach(k=>{
    let raw = (data.timings && data.timings[k]) ? data.timings[k] : null;
    if(!raw) return;
    let t = String(raw).replace(/[^0-9:]/g,'');
    prayerSchedule[k] = t;
    $("<li>").attr('data-prayer',k).text(k + " - " + t).appendTo("#prayer-times");
  });

  $("#getTimesBtn").prop('disabled',false).text('Get Prayer Times');
  $("#myLocBtn").prop('disabled',false).text('Use My Location');

  $("#prayerTZInfo").text("Timings for timezone: " + tz);

  lastPlayed = {};
  updatePrayerUI();
}

// utility to get parts of the current date in target timezone
function getTZDateKey(timezone){
  const parts = new Intl.DateTimeFormat('en-GB', {timeZone: timezone, year:'numeric', month:'2-digit', day:'2-digit'}).formatToParts(new Date());
  let y,m,d;
  parts.forEach(p=>{
    if(p.type==='year') y = p.value;
    if(p.type==='month') m = p.value;
    if(p.type==='day') d = p.value;
  });
  if(!y || !m || !d){
    const s = new Intl.DateTimeFormat('en-GB', {timeZone: timezone, year:'numeric', month:'2-digit', day:'2-digit'}).format(new Date());
    const [dd,mm2,yy] = s.split('/');
    y = yy; m = mm2; d = dd;
  }
  return `${y}-${m}-${d}`;
}

function hhmmToSeconds(str){
  const [h,m] = (String(str).split(':').map(x=>parseInt(x,10)));
  return ( (isNaN(h)?0:h)*3600 + (isNaN(m)?0:m)*60 );
}

function formatHMS(sec){
  const h = Math.floor(sec/3600); sec %= 3600;
  const m = Math.floor(sec/60); const s = sec%60;
  return `${h}h ${String(m).padStart(2,'0')}m ${String(s).padStart(2,'0')}s`;
}

function updatePrayerUI(){
  if(!prayerSchedule || Object.keys(prayerSchedule).length===0) {
    $("#nextPrayerInfo").text('');
    $("#prayer-times li").removeClass('highlight');
    return;
  }

  const tz = prayerTimezone || Intl.DateTimeFormat().resolvedOptions().timeZone;
  const nowStr = new Intl.DateTimeFormat('en-GB', {timeZone: tz, hour12:false, hour:'2-digit', minute:'2-digit', second:'2-digit'}).format(new Date());
  const nowParts = nowStr.split(':').map(x=>parseInt(x,10));
  const nowSeconds = nowParts[0]*3600 + nowParts[1]*60 + nowParts[2];
  const nowHHMM = `${String(nowParts[0]).padStart(2,'0')}:${String(nowParts[1]).padStart(2,'0')}`;

  let arr = [];
  for(const [k,t] of Object.entries(prayerSchedule)){
    const clean = String(t).replace(/[^0-9:]/g,'');
    arr.push({name:k, time:clean, seconds: hhmmToSeconds(clean)});
  }
  arr.sort((a,b)=>a.seconds - b.seconds);

  let next = arr.find(x => x.seconds > nowSeconds);
  if(!next){
    next = arr[0];
  }

  let active = arr.find(x => x.time === nowHHMM);

  $("#prayer-times li").removeClass('highlight');
  if(active){
    $(`#prayer-times li[data-prayer="${active.name}"]`).addClass('highlight');
  } else {
    if(next) $(`#prayer-times li[data-prayer="${next.name}"]`).addClass('highlight');
  }

  const dateKey = getTZDateKey(tz);
  if(active){
    const key = `${tz}|${active.name}|${dateKey}`;
    if(!lastPlayed[key]){
      try {
        const a = document.getElementById('azan-audio');
        a.currentTime = 0;
        const playPromise = a.play();
        if(playPromise !== undefined){
          playPromise.catch(err => {
            console.warn("Autoplay prevented:", err);
          });
        }
      } catch(e){ console.warn("Audio play error:", e); }
      lastPlayed[key] = true;
    }
  }

  const nextSeconds = next.seconds;
  let delta = nextSeconds - nowSeconds;
  if(delta <= 0) delta += 24*3600;
  $("#nextPrayerInfo").text(`Next: ${next.name} โ ${next.time} (in ${formatHMS(delta)})`);
}

// start watcher: update UI every second
setInterval(()=>{
  try{
    updatePrayerUI();
  }catch(e){
    console.error(e);
  }
}, 1000);

// -----------------------------
// Login/Register
// -----------------------------
$("#toRegister").click(()=>{$("#loginBox").hide();$("#registerBox").show();});
$("#toLogin").click(()=>{$("#registerBox").hide();$("#loginBox").show();});

$("#registerBtn").click(function(){
  let user = {
    first:$("#firstName").val(),
    middle:$("#middleName").val(),
    last:$("#lastName").val(),
    father:$("#fatherName").val(),
    age:$("#age").val(),
    gender:$("#gender").val(),
    phone:$("#phone").val(),
    username:$("#regUsername").val(),
    password:$("#regPassword").val()
  };
  if(!user.username || !user.password){alert("Fill required fields");return;}
  localStorage.setItem("user_"+user.username,JSON.stringify(user));
  alert("โ Registered! Please login.");
  $("#toLogin").click();
});

$("#loginBtn").click(function(){
  let u=$("#loginUsername").val(),p=$("#loginPassword").val();
  let stored=localStorage.getItem("user_"+u);
  if(!stored){alert("โ User not found");return;}
  let user=JSON.parse(stored);
  if(user.password!==p){alert("โ Wrong password");return;}
  // keep session for this tab
  sessionStorage.setItem('loggedInUser', u);
  loadDailyContent();
});

$("#logoutBtn").click(()=>{ 
  sessionStorage.removeItem('loggedInUser');
  // reload to reset state
  location.reload();
});
</script>
</body>
</html>

